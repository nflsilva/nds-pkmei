#include "app.h"
#include "gen3_save.h"

static PrintConsole topScreen;
static PrintConsole bottomScreen;

char hexToChar(u8 hex) {
	if (hex > 186 && hex < 213) {
		return 65 + (hex - 186);
	}
	if (hex > 212 && hex < 239) {
		return 97 + (hex - 186);
	}
}

u8 hexToUINT(char hex) {
	if (hex > '/' && hex < ':') {
		return (hex - '0');
	}
	else if (hex > '\'' && hex < 'g') {
		return 10 + (hex - 'a');
	}
}


int main() {

	// Initialize consoles
	videoSetMode(MODE_0_2D);
	videoSetModeSub(MODE_0_2D);

	vramSetBankA(VRAM_A_MAIN_BG);
	vramSetBankC(VRAM_C_SUB_BG);

	consoleInit(&topScreen, 3, BgType_Text4bpp, BgSize_T_256x256, 31, 0, true, true);
	consoleInit(&bottomScreen, 3, BgType_Text4bpp, BgSize_T_256x256, 31, 0, false, true);

	// Enable accessing slot 2:
	sysSetCartOwner(true);


	gen3_save* s = new gen3_save();

	int offset = 0;
	while (true) {


		while (true) {

			swiWaitForVBlank();

			scanKeys();
			uint32 input = keysDownRepeat();

			if (input & KEY_A) {
				iprintf("Hello Patricia!\n");
				break;
			}
			if (input & KEY_START) {
				u8 gender = s->get_game_save_a()->get_trainer_info()->get_player_gender();
				iprintf("%d \n", gender);

				rival_info* ria = s->get_game_save_a()->get_rival_info();
				rival_info* rib = s->get_game_save_b()->get_rival_info();

				u8* rivalA = ria->get_name();
				u8* rivalB = rib->get_name();

				iprintf("Rival A: ");
				for (int i = 0; i < 8; i++) {
					iprintf("%c", hexToChar(rivalA[i]));
				}
				iprintf("\n");
				iprintf("Rival B: ");
				for (int i = 0; i < 8; i++) {
					iprintf("%c", hexToChar(rivalB[i]));
				}
				iprintf("\n");

				break;
			}
			if (input & KEY_SELECT) {

				trainer_info* ia = s->get_game_save_a()->get_trainer_info();
				trainer_info* ib = s->get_game_save_b()->get_trainer_info();

				iprintf("Changing gender\n");
				ia->set_player_gender(0x01);
				ib->set_player_gender(0x01);

				iprintf("Computing checksum\n");
				u16 checksuma = ia->compute_checksum();
				u16 checksumb = ib->compute_checksum();

				iprintf("Changing checksum\n");
				ia->set_checksum(checksuma);
				ib->set_checksum(checksumb);

				iprintf("Done.\n");
				break;
			}
			if (input & KEY_X) {
				iprintf("Writing to cartridge.\n");
				bool result = s->write_save_to_cartridge();
				iprintf("%d \n", result);
				break;
			}

			if (input & KEY_Y) {
				iprintf("Injecting Aurora Ticket.\n");

				int size = 1420;

				u8 eon_ecard_raw[] = "10ea000033080101b8610000024713010100210d800100bb01bf0000024a13010100210d800100bb01bf0000022bce00bb01bf0000026a5abdc9000002666d4613010100210d800000bb01c00000021a008013011a018001000900295308bd04010002666d6c0dbd83010002666d6c02bebbbeb1fd01ab00c1e3e3d800e8e300e7d9d900ede3e9abfecedcd9e6d9b4e700d500e0d9e8e8d9e600dcd9e6d900dae3e600ede3e9b8fd01adffbebbbeb1c3e800d5e4e4d9d5e6e700e8e300d6d900d500dad9e6e6ed00cec3bdc5bfceadfed6e9e800c3b4ead900e2d9ead9e600e7d9d9e200e3e2d900e0dddfd900dde800d6d9dae3e6d9adfad3e3e900e7dce3e9e0d800eadde7dde800c6c3c6d3bdc9d0bf00d5e2d800d5e7dffed5d6e3e9e800dde800e8dcd9e6d9adffbebbbeb1fd01b400e8dcd900c5bfd300c3cebfc7cd00cac9bdc5bfce00dde2feede3e9e600bcbbc100dde700dae9e0e0adfbc7e3ead900e7e3e1d900dfd9ed00dde8d9e1e700dae3e600e7d5dad9dfd9d9e4dde2dbfedde200ede3e9e600cabdb400e8dcd9e200d7e3e1d900e7d9d900e1d9adff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000033000000011e1301";
				u8 eon_italy_raw[] = "f09b000033080101b8520000024713010100210d800100bb01b00000024a13010100210d800100bb01b00000022bce00bb01b00000026a5abdba000002666d4613010100210d800000bb01b10000021a008013011a018001000900295308bd08010002666d6c0dbd3a010002666d6c02bebbbef000c3e800d5e4e4d9d5e6e700e8e300d6d900d500dad9e6e6ed00cec3bdc5bfceb8fed6e9e800c3b4ead900e2d9ead9e600e7d9d9e200e3e2d900e0dddfd900dde800d6d9dae3e6d9adffd3e3e900e7dce3e9e0d800eadde7dde800c6c3c6d3bdc9d0bf00d5e2d800d5e7dffed5d6e3e9e800dde800e8dcd9e6d9adffcedcd900bcbbc100dde700dae9e0e000adadadfbd3e3e900e7dce3e9e0d800e1d5dfd900e6e3e3e100d5e2d800d7e3e1d900d6d5d7dffee0d5e8d9e6adff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ac00000001971301";
				
				u8 eeee_eurora_raw[] = "fc850000e803ffff00000000080000000000000000000000bbcfccc9ccbbcec3bdc5bfce00000000000000000000000000000000000000000000000000000000bfecd7dcd5e2dbd900bdd5e6d80000000000000000000000000000000000c1e300e8e300e8dcd900e7d9d7e3e2d800dae0e3e3e600e3da00e8dcd900cac9c51bc7c9c8000000bdbfc8cebfcc00d5e2d800e1d9d9e800e8dcd900d8d9e0ddead9e6ed00e4d9e6e7e3e200dde20000dbe6d9d9e2ad00ccd9d7d9ddead900e8dcd900bbcfccc9ccbbcec3bdc5bfce00d5e2d80000000000e8dcd9e200e7d5ead900e8dcd900dbd5e1d9abab0000000000000000000000000000000000000000bee300e2e3e800e8e3e7e700e8dcdde700bfecd7dcd5e2dbd900bdd5e6d800000000000000000000d6d9dae3e6d900e6d9d7d9ddeadde2db00e8dcd900bbcfccc9ccbbcec3bdc5bfceabab0000000000000000000000000000000000ffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000eaa6000033ffffffb8580200086a5a2b3a01bb01bc0200082bad01bb01bc0200084773010100210d800100bb01bc020008bdc5020008666d4673010100210d800000bb01b30200081a008073011a01800100090029d508293a01bd22030008666d6c02bdb3030008666d6c02bd86030008666d6c02cedcd5e2df00ede3e900dae3e600e9e7dde2db00e8dcd900c7d3cdcebfccd3fec1c3c0ce00cdede7e8d9e1adfbd3e3e900e1e9e7e800d6d900fd01adfecedcd9e6d900dde700d500e8ddd7dfd9e800dcd9e6d900dae3e600ede3e9adffc3e800d5e4e4d9d5e6e700e8e300d6d900dae3e600e9e7d900d5e800e8dcd9fec6c3c6d3bdc9d0bf00bdc3ced300e4e3e6e8adfbd1dced00e2e3e800dbddead900dde800d500e8e6ed00d5e2d800e7d9d900ebdcd5e8fedde800dde700d5d6e3e9e8acffcedcd5e2df00ede3e900dae3e600e9e7dde2db00e8dcd900c7d3cdcebfccd3fec1c3c0ce00cdede7e8d9e1adffc9dcb800c3b4e100e7e3e6e6edb800fd01adfed3e3e9e600bcbbc1b4e700c5bfd300c3cebfc7cd00cac9bdc5bfce00dde700dae9e0e0adfbcae0d9d5e7d900e7e8e3e6d900e7e3e1d9e8dcdde2db00e3e200ede3e9e600cabdb8fee8dcd9e200d7e3e1d900d6d5d7df00dae3e600e8dcdde7adffb8270400086a5a2b3a01bb018b0400082bad01bb018b0400084773010100210d800100bb018b040008bd94040008666d4673010100210d800000bb01820400081a008073011a01800100090029d508293a01bded040008666d6c02bd6b050008666d6c02bd42050008666d6c02c7d9e6d7dd00d8b4e9e8dde0dde7d9e600e0d900e7ede7e81ae1d9febdbbbebfbbcf00c7d3cdceadfbd0e3e9e700d8d9ead9ee001ce8e6d900fd01adfec3e000ed00d500e9e200e8ddd7dfd9e800e4e3e9e600eae3e9e7adffc3e000e4d9e9e8001ce8e6d900e9e8dde0dde71b00d5e900e4e3e6e800d8d9fec8bfc8cfbdccc3cbcfbfadfbbfe7e7d5edd9eeaee0d900e4e3e9e600eae3dde600d8d900e5e9e3dd00fedde000e7b4d5dbdde8adffc7d9e6d7dd00d8b4e9e8dde0dde7d9e600e0d900e7ede7e81ae1d9febdbbbebfbbcf00c7d3cdceadffc9dcb800ded900e6d9dbe6d9e8e8d900fd01ad00c6d500cac9bdc2bffec9bcc4ad00ccbbccbfcd00d8e900cdbbbd00d9e7e800e4e0d9dde2d9adfbc0d5dde8d9e700e0d900e8e6dd00d8d5e2e700eae3e8e6d900cdbbbd00d9e8fee6d9ead9e2d9ee00e4e0e9e700e8d5e6d8adffb8d90500086a5a2b3a01bb013d0600082bad01bb013d0600084773010100210d800100bb013d060008bd46060008666d4673010100210d800000bb01340600081a008073011a01800100090029d508293a01bda9060008666d6c02bd3a070008666d00";
				u8 eeee_mystic_raw[] = "6d020000e903ffff000000001c000000b1c7d3cdcec3bd00cec3bdc5bfceb200bfecd7dcd5e2dbd900bdd5e6d80000000000000000000000cebdc100d1c9ccc6be00bdc2bbc7cac3c9c8cdc2c3cacd00a3a1a1a600000000000000000000c1e300e8e300e8dcd900e7d9d7e3e2d800dae0e3e3e600e3da00e8dcd900cac9c51bc7c9c8000000bdbfc8cebfcc00d5e2d800e1d9d9e800e8dcd900d8d9e0ddead9e6ed00e4d9e6e7e3e200dde20000dbe6d9d9e2ad00ccd9d7d9ddead900e8dcd900c7d3cdcec3bd00cec3bdc5bfce00d5e2d800000000e8dcd9e200e7d5ead900e8dcd900dbd5e1d9abab0000000000000000000000000000000000000000bee300e2e3e800e8e3e7e700e8dcdde700bfecd7dcd5e2dbd900bdd5e6d800000000000000000000d6d9dae3e6d900e6d9d7d9ddeadde2db00e8dcd900c7d3cdcec3bd00cec3bdc5bfceabab00000000000000000000000000000000ffff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000038d0000033ffffffb8580200086a5a2b3b01bb01c50200082b9100bb01c50200082b9200bb01c50200084772010100210d800100bb01c5020008bdce020008666d4672010100210d800000bb01bc0200081a008072011a01800100090029e008293b01bd2b030008666d6c02bdbc030008666d6c02bd8f030008666d6c02cedcd5e2df00ede3e900dae3e600e9e7dde2db00e8dcd900c7d3cdcebfccd3fec1c3c0ce00cdede7e8d9e1adfbd3e3e900e1e9e7e800d6d900fd01adfecedcd9e6d900dde700d500e8ddd7dfd9e800dcd9e6d900dae3e600ede3e9adffc3e800d5e4e4d9d5e6e700e8e300d6d900dae3e600e9e7d900d5e800e8dcd9fec6c3c6d3bdc9d0bf00bdc3ced300e4e3e6e8adfbd1dced00e2e3e800dbddead900dde800d500e8e6ed00d5e2d800e7d9d900ebdcd5e8fedde800dde700d5d6e3e9e8acffcedcd5e2df00ede3e900dae3e600e9e7dde2db00e8dcd900c7d3cdcebfccd3fec1c3c0ce00cdede7e8d9e1adffc9dcb800c3b4e100e7e3e6e6edb800fd01adfed3e3e9e600bcbbc1b4e700c5bfd300c3cebfc7cd00cac9bdc5bfce00dde700dae9e0e0adfbcae0d9d5e7d900e7e8e3e6d900e7e3e1d9e8dcdde2db00e3e200ede3e9e600cabdb8fee8dcd9e200d7e3e1d900d6d5d7df00dae3e600e8dcdde7adff00b50a48002110220cf01cfe0849002008700120404202f01dfa00f00bf80006002801d000f04ef801bc0047000000031000000330b50d4d00242005000c00210a4a80235b010cf085fb281c084904220cf0a4fd00280fd1002000f089f8054aa9180968884207d101200be000000002102c0108fc0f00000134012cdddd00f005f8002030bc02bc0847000081b0094a002000900848694601604260074981608068074800681060b4320120108001b07047000000000002d400000400040085102c0108f0b557464e464546e0b481b001270020824600253803791c89461149ce1911494018804634786c400120044024013c192004000c0021424680235b010cf028fb381c00f033f8a40007490c19216888420cd13078454001200540357017e00000040000020000000214000002012d0bd1514600910b4869460160414641600a4981608068504630700135012dcadd4f460f2fbedd01b038bc9846a146aa46f0bc01bc0047d40000040004008510b58023db000022002800d1013b9a4208da064900034418191c01cc121801390029fad1101c10bc02bc084700000002f0b5254f2548002141563a1c031c002959d1002522490020085600280ad10f2d61d001350f2d05dc68180078000600160028f4d000201856002844d10125184ea819007800060016002810d03a1d52191078012148401070107800012c18281cfff7b6ffa200391c14318900";

				u8 frlg_aurora_raw[] = "6cd00000e803ffff000000000800000000000000000000b1bbcfccc9ccbb00cec3bdc5bfceb2000000000000000000000000000000000000000000bfecd7dcd5e2dbd900bdd5e6d800a3a1a1a500c0bbc6c6000000000000000000000000c1e300e8e300e8dcd900e7d9d7e3e2d800dae0e3e3e600e3da00e8dcd900cac9c51bc7c9c8000000bdbfc8cebfcc00d5e2d800e1d9d9e800e8dcd900d8d9e0ddead9e6ed00e4d9e6e7e3e200dde20000dbe6d9d9e2ad00ccd9d7d9ddead900e8dcd900bbcfccc9ccbb00cec3bdc5bfce00d5e2d800000000e8dcd9e200e7d5ead900e8dcd900dbd5e1d9abab0000000000000000000000000000000000000000bee300e2e3e800e8e3e7e700e8dcdde700bfecd7dcd5e2dbd900bdd5e6d800000000000000000000d6d9dae3e6d900e6d9d7d9ddeadde2db00e8dcd900bbcfccc9ccbb00cec3bdc5bfceabab00000000000000000000000000000000ffff0000000000000000000000000000000000000000000000000000000004dfc9e8163102ed1a2d941a000000000000000000000000000000000000000000000000000000005b1c000033ffffffb8282701086a5a2ba702bb018c2701082be402bb018c2701084773010100210d800100bb018c270108bd95270108666d4673010100210d800000bb01832701081a008073011a018001000900294b0829a702bdf2270108666d6c02bd84280108666d6c02bd57280108666d6c02cedcd5e2df00ede3e900dae3e600e9e7dde2db00e8dcd900c7d3cdcebfccd3fec1c3c0ce00cdede7e8d9e1adfbd3e3e900e1e9e7e800d6d900fd01adfecedcd9e6d900dde700d500e8ddd7dfd9e800dcd9e6d900dae3e600ede3e9adffc3e800d5e4e4d9d5e6e700e8e300d6d900dae3e600e9e7d900d5e800e8dcd9fed0bfccc7c3c6c3c9c800bdc3ced300e4e3e6e8adfbd1dced00e2e3e800dbddead900dde800d500e8e6ed00d5e2d800e7d9d900ebdcd5e8fedde800dde700d5d6e3e9e8acffcedcd5e2df00ede3e900dae3e600e9e7dde2db00e8dcd900c7d3cdcebfccd3fec1c3c0ce00cdede7e8d9e1adffc9dcb800c3b4e100e7e3e6e6edb800fd01ad00d3e3e9e600bcbbc1b4e7fec5bfd300c3cebfc7cd00cac9bdc5bfce00dde700dae9e0e0adfbcae0d9d5e7d900e7e8e3e6d900e7e3e1d9e8dcdde2db00e3e200ede3e9e600cabdb8fee8dcd9e200d7e3e1d900d6d5d7df00dae3e600e8dcdde7adff02000200ffff000000000000000000000000000000000000000000000000000000000000dd36000800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101004155524f000000000000000000000000000000000000000000000000000000000000000000000000000010100001101000010000000100000011000000011100000100000001000000001010001010100000010010001000100010000100000101000001010000010000101010001010100000001011110110000000100000001000000000111101000010100000101011111101000000010000100000001000000001001011000000001010000010100001000010100000010001000000100000000001000000000000101000101010111111010010000010101000101000010110000101100001000010100000111000011000111100010001010110000100010001000011000000001010001010101011110000000100001111010000100010000000001111000000101000001010000001000010000000010000001000000000010000001000000010100000001010101101100010001000100010001000000110000000010000001010000010100011110000000001000010000000000010000000001111010000101000101010101111000000010000001000000010001000000000111100";
				u8 frlg_mystic_raw[] = "f2d00000e903ffff000000001c00000000000000000000b1c7d3cdcec3bd00cec3bdc5bfceb20000000000000000000000000000000000000000000000000000bfecd7dcd5e2dbd900bdd5e6d80000000000000000000000000000000000c1e300e8e300e8dcd900e7d9d7e3e2d800dae0e3e3e600e3da00e8dcd900cac9c51bc7c9c8000000bdbfc8cebfcc00d5e2d800e1d9d9e800e8dcd900d8d9e0ddead9e6ed00e4d9e6e7e3e200dde20000dbe6d9d9e2ad00ccd9d7d9ddead900e8dcd900c7d3cdcec3bd00cec3bdc5bfce00d5e2d800000000e8dcd9e200e7d5ead900e8dcd900dbd5e1d9abab0000000000000000000000000000000000000000bee300e2e3e800e8e3e7e700e8dcdde700bfecd7dcd5e2dbd900bdd5e6d800000000000000000000d6d9dae3e6d900e6d9d7d9ddeadde2db00e8dcd900c7d3cdcec3bd00cec3bdc5bfceabab00000000000000000000000000000000ffff00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000005c32000033ffffffb87c2901086a5a2ba802bb01e92901082bf202bb01e92901082bf302bb01e92901084772010100210d800100bb01e9290108bdf2290108666d4672010100210d800000bb01e02901081a008072011a018001000900294a0829a802bd4f2a0108666d6c02bde12a0108666d6c02bdb42a0108666d6c02cedcd5e2df00ede3e900dae3e600e9e7dde2db00e8dcd900c7d3cdcebfccd3fec1c3c0ce00cdede7e8d9e1adfbd3e3e900e1e9e7e800d6d900fd01adfecedcd9e6d900dde700d500e8ddd7dfd9e800dcd9e6d900dae3e600ede3e9adffc3e800d5e4e4d9d5e6e700e8e300d6d900dae3e600e9e7d900d5e800e8dcd9fed0bfccc7c3c6c3c9c800bdc3ced300e4e3e6e8adfbd1dced00e2e3e800dbddead900dde800d500e8e6ed00d5e2d800e7d9d900ebdcd5e8fedde800dde700d5d6e3e9e8acffcedcd5e2df00ede3e900dae3e600e9e7dde2db00e8dcd900c7d3cdcebfccd3fec1c3c0ce00cdede7e8d9e1adffc9dcb800c3b4e100e7e3e6e6edb800fd01ad00d3e3e9e600bcbbc1b4e7fec5bfd300c3cebfc7cd00cac9bdc5bfce00dde700dae9e0e0adfbcae0d9d5e7d900e7e8e3e6d900e7e3e1d9e8dcdde2db00e3e200ede3e9e600cabdb8fee8dcd9e200d7e3e1d900d6d5d7df00dae3e600e8dcdde7adff00000002000200ffff000000000000000000000000000000000000000000000000000000000000d538000800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000400000040914004155524f000000000000000000000000000000000000000000000000000000000000000000000000000010100001101000010000000100000011000000011100000100000001000000001010001010100000010010001000100010000100000101000001010000010000101010001010100000001011110110000000100000001000000000111101000010100000101011111101000000010000100000001000000001001011000000001010000010100001000010100000010001000000100000000001000000000000101000101010111111010010000010101000101000010110000101100001000010100000111000011000111100010001010110000100010001000011000000001010001010101011110000000100001111010000100010000000001111000000101000001010000001000010000000010000001000000000010000001000000010100000001010101101100010001000100010001000000110000000010000001010000010100011110000000001000010000000000010000000001111010000101000101010101111000000010000001000";


				u8* event_data = (u8*)malloc(size * sizeof(u8));

				for (int r = 0, p = 0; p < size; r += 2, p++) {
					char k0 = eeee_mystic_raw[r];
					char k1 = eeee_mystic_raw[r + 1];
					u8 n0 = hexToUINT(k0);
					u8 n1 = hexToUINT(k1);
					event_data[p] = ((n0 * 16) + n1);;
				}

				int WC_OFFSET_E = 0x56C;
				int WC_SCRIPT_OFFSET_E = 0x8A8;

				//int WC_OFFSET_FRLG = 0x460;
				//int WC_SCRIPT_OFFSET_FRLG = 0x79C;

				rival_info* ria = s->get_game_save_a()->get_rival_info();
				rival_info* rib = s->get_game_save_b()->get_rival_info();

				// Checksum + WC?
				ria->set_data_block(event_data, 0x4 + 0x14C, WC_OFFSET_E);
				rib->set_data_block(event_data, 0x4 + 0x14C, WC_OFFSET_E);

				// Icon?
				ria->set_data_block(&event_data[0x4 + 0x14C + 0xA], 0x2, WC_OFFSET_E + 0x4 + 0x14C + 0xA);
				rib->set_data_block(&event_data[0x4 + 0x14C + 0xA], 0x2, WC_OFFSET_E + 0x4 + 0x14C + 0xA);

				// Data?
				ria->set_data_block(&event_data[0x4 + 0x14C + 0x28 + 0x28], 4 + 1000, WC_SCRIPT_OFFSET_E);
				rib->set_data_block(&event_data[0x4 + 0x14C + 0x28 + 0x28], 4 + 1000, WC_SCRIPT_OFFSET_E);

				// Checksumn
				ria->set_checksum(ria->compute_checksum());
				rib->set_checksum(rib->compute_checksum());

				iprintf("Done!\n");
				break;
			}


		}


	}

	return 0;
}


